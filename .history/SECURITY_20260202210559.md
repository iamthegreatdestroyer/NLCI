# Security Policy

## Supported Versions

We provide security updates for the following versions:

| Version | Supported          |
| ------- | ------------------ |
| 1.x.x   | :white_check_mark: |
| < 1.0   | :x:                |

## Reporting a Vulnerability

**Please do not report security vulnerabilities through public GitHub issues.**

Instead, please report them via one of the following methods:

### Preferred: Security Advisory

1. Go to the [Security Advisories page](https://github.com/iamthegreatdestroyer/NLCI/security/advisories)
2. Click "Report a vulnerability"
3. Fill out the form with details

### Alternative: Email

Send an email to: **security@nlci.example.com** (replace with actual contact)

Include:
- Description of the vulnerability
- Steps to reproduce
- Potential impact
- Suggested fix (if any)

## Response Timeline

- **Initial Response**: Within 48 hours
- **Status Update**: Within 7 days
- **Fix Timeline**: Depends on severity
  - Critical: 1-7 days
  - High: 7-30 days
  - Medium: 30-90 days
  - Low: Next release cycle

## Security Update Process

1. **Triage**: Assess severity and impact
2. **Fix Development**: Create patch in private fork
3. **Testing**: Verify fix doesn't introduce regressions
4. **Disclosure**: Coordinate disclosure with reporter
5. **Release**: Publish security advisory and patched version
6. **Notification**: Alert users via GitHub, npm, and email

## Vulnerability Disclosure Policy

We follow coordinated disclosure:

- We will work with you to understand and resolve the issue
- We request that you give us reasonable time to fix the issue before public disclosure
- We will acknowledge your contribution (unless you prefer anonymity)

## Security Best Practices

### For Users

**Keep Dependencies Updated**
```bash
# Check for updates
pnpm outdated

# Update dependencies
pnpm update
```

**Use Lock Files**
- Always commit `pnpm-lock.yaml`
- Ensure deterministic builds

**Environment Security**
```bash
# Never commit credentials
echo ".env" >> .gitignore

# Use environment variables
export NLCI_API_KEY="your-key-here"
```

**Validate Inputs**
```typescript
import { NlciEngine } from '@nlci/core';

// ‚úÖ Good - Validate file paths
const safePath = path.resolve(userInput);
if (!safePath.startsWith(projectRoot)) {
  throw new Error('Path traversal attempt detected');
}

// ‚ùå Bad - Blindly trust user input
await engine.indexFile(userInput);
```

### For Contributors

**Code Review**
- All code must be reviewed before merging
- Security-sensitive changes require maintainer approval

**Dependency Audits**
```bash
# Run security audit
pnpm audit

# Fix vulnerabilities
pnpm audit fix
```

**Static Analysis**
```bash
# Type checking
pnpm typecheck

# Linting with security rules
pnpm lint
```

## Known Security Considerations

### LSH Index Security

**Data Leakage via LSH Queries**
- LSH queries reveal some information about query vectors
- Consider this if handling sensitive code
- Mitigation: Use encryption at rest for indexes

**Hash Collision Attacks**
- LSH uses random projections
- Low probability of intentional collisions
- Mitigation: Use cryptographic random number generator

### File System Access

**Path Traversal**
```typescript
// ‚úÖ Safe - Normalize and validate paths
import path from 'path';

function safePath(userPath: string, baseDir: string): string {
  const normalized = path.normalize(userPath);
  const resolved = path.resolve(baseDir, normalized);
  
  if (!resolved.startsWith(baseDir)) {
    throw new Error('Path traversal detected');
  }
  
  return resolved;
}
```

**Symlink Attacks**
```typescript
// ‚úÖ Safe - Check for symlinks
import fs from 'fs';

function isSafeFile(filePath: string): boolean {
  const stats = fs.lstatSync(filePath);
  return stats.isFile() && !stats.isSymbolicLink();
}
```

### VS Code Extension Security

**Command Injection**
```typescript
// ‚úÖ Safe - Use spawn with argument array
import { spawn } from 'child_process';

const proc = spawn('nlci', ['scan', safeDir]);

// ‚ùå Dangerous - Shell command with user input
exec(`nlci scan ${userInput}`);
```

**WebView Security**
- All webviews use Content Security Policy
- No inline scripts allowed
- External resources must be explicitly allowed

## Dependencies

### Automated Scanning

We use:
- **Dependabot**: Automated dependency updates
- **npm audit**: Vulnerability scanning
- **Snyk**: Continuous monitoring (optional)

### Dependency Policy

- Update dependencies monthly
- Critical security updates: immediate
- Pin exact versions in `pnpm-lock.yaml`
- Review dependency changes in PRs

## Compliance

### License Compliance

- AGPL-3.0-or-later for open source
- Commercial license for proprietary use
- Ensure compliance when using NLCI

### Data Privacy

NLCI processes source code:
- Code stays local by default
- No telemetry without explicit opt-in
- Indexes stored locally (configurable)

## Security Features

### Current

- ‚úÖ Type-safe TypeScript codebase
- ‚úÖ Input validation on all external inputs
- ‚úÖ Sandboxed VS Code extension
- ‚úÖ No remote code execution
- ‚úÖ Secure file system access

### Planned

- üîÑ Index encryption at rest
- üîÑ Optional cloud sync with E2E encryption
- üîÑ Audit logging for enterprise deployments
- üîÑ Role-based access control (RBAC)

## Bug Bounty Program

Currently, we do not have a formal bug bounty program. However:

- We recognize security researchers in release notes
- Severe vulnerabilities may be eligible for rewards (case-by-case)
- Contact us to discuss potential rewards

## Security Advisories

View published advisories:
- [GitHub Security Advisories](https://github.com/iamthegreatdestroyer/NLCI/security/advisories)
- [npm Security Advisories](https://www.npmjs.com/advisories)

## Contact

**Security Team**: security@nlci.example.com

**GPG Key**: Available upon request

---

**Last Updated**: February 2, 2026

Thank you for helping keep NLCI secure! üîí
